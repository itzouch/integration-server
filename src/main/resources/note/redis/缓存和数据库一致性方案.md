**缓存和数据库数据一致性解决方案**

普通查询流程
1. 先查缓存，缓存有，return。
2. 缓存没有，查库，set缓存，return。

如果更新缓存
1. 删除缓存，update数据库。
或
2. update数据库，删除缓存。

在1中可能导致的问题：1.删除缓存后，如果是并发场景，有可能在update数据库时还没提交。别的线程正好查了缓存不存在，把旧的值放入到了缓存中，导致数据不一致。
在2中可能导致的问题：1.update数据库后，线程中断，没有删除缓存，导致数据不一致。

综上所述，方案2明显优于方案2。 线程中断可以引入MQ机制重试，当然MQ的高可用以及消息不丢失也是问题。

